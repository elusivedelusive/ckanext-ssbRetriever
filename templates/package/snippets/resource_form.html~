{% import 'macros/form.html' as form %}
{% set data = data or {} %}
{% set errors = errors or {} %}
{% set action = form_action or h.url_for(controller='package', action='new_query_resource', id=pkg_name) %}


<form id="resource-edit" class="dataset-form dataset-resource-form form-horizontal" method="post" action="{{ action }}" data-module="basic-form resource-form" enctype="multipart/form-data">
<input name="id" value="{{ data.id }}" type="hidden"/>

<input type="url" id="query-url" placeholder="Enter SSB Table URL Here" class="control-full"> </input> <br>
<textarea rows="4" cols="50" name ="query" form="resource-edit"> </textarea><br>

	{% set url = "http://data.ssb.no/api/v0/no/table/08921" %}

	{% resource 'js/query_form.js' %}


<input type=button data-module="query_form" data-module-url="document.getElementById('query-url')" value="press me"> </button>

{% block basic_fields %}l
	{% block basic_fields_name %}
      		{{ form.input('name', id='field-name', label=_('Name'), placeholder=_('eg. January 2011 Gold Prices'), value=data.name, error=errors.name,
		classes=['control-full']) }}
    	{% endblock %}

    	{% block basic_fields_description %}
      		{{ form.markdown('description', id='field-description', label=_('Description'), placeholder=_('Some useful notes about the data'), 			value=data.description, error=errors.description) }}
    	{% endblock %}

    	{% block basic_fields_format %}
      		{% set format_attrs = {'data-module': 'autocomplete', 'data-module-source': '/api/2/util/resource/format_autocomplete?incomplete=?'} %}
      		{% call form.input('format', id='field-format', label=_('Format'), placeholder=_('eg. CSV, XML or JSON'), value=data.format, 			error=errors.format, classes=['control-medium'], attrs=format_attrs) %}
        		<span class="info-block info-block-small">
          			<i class="icon-info-sign"></i>
          			{{ _('This will be guessed automatically. Leave blank if you wish') }}
        		</span>
      		{% endcall %}
    	{% endblock %}
{% endblock basic_fields %}

  <div class="form-actions">
      	{% block add_button %}
      		<button class="btn btn-primary" name="save" value="go-dataset-complete" type="submit" >{{ _('Add') }}</button>
      	{% endblock %}
	{{ form.required_message() }}
  </div>
</form>
